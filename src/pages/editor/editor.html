<ion-header *ngIf="!api.state.fullscreen">
  <ion-toolbar>

      <button ion-button menuToggle>
        <ion-icon name="menu"></ion-icon>
      </button>

    <ion-title *ngIf="api.data.length > 0 && api.data[api.getCurrent()]">
      <ion-input
        (ngModelChange)="api.changeDebounce()"
        [(ngModel)]='api.data[api.getCurrent()].name'
        placeholder="{{api.data[api.getCurrent()].name}}">
      </ion-input>
    </ion-title>


    <ion-buttons end *ngIf="api.state.initialized">

      <button ion-button small  icon-only [disabled]="api.state.busy == 0">
        <ion-icon name="sync"></ion-icon>
      </button>


      <button *ngIf="api.data.length > 0 && api.data[api.getCurrent()]" ion-button small  icon-only (click)="api.change()" [disabled]="api.data[api.getCurrent()].modified == 0">
        <ion-icon name="send"></ion-icon>
      </button>

    </ion-buttons>

  </ion-toolbar>
</ion-header>

<!--<ion-fab top left edge *ngIf="api.fullscreen">
   <button ion-fab mini menuToggle><ion-icon name="menu"></ion-icon></button>
 </ion-fab>-->


<ion-content class="no-scroll paper" [ngClass]="{'fullscreen': api.state.fullscreen}">
  <ion-slides #mySlider
  [direction] = "vertical"
  [slidesPerView] = "1"
  [initialSlide] = "api.getCurrent()"
  [pager] = "true"
  [paginationType] = "fraction"
  [parallax] = "true"
  (ionSlideDidChange)="slideDidChange()" (ionSlideWillChange)="slideWillChange()">
    <ion-slide *ngFor="let e of api.data; trackBy: trackByFn">
      <ion-item [hidden]="!api.state.initialized">
        <ion-label stacked>Titel</ion-label>
        <ion-input [(ngModel)]="e.title" (ngModelChange)="api.changeDebounce()" placeholder="{{e.title}}"></ion-input>
      </ion-item>
      <div class="editorWrapper">
        <!--<codemirror [(ngModel)]="e.body" (blur)="api.change()" (change)="e.modified = 1;" [ngModelOptions]="{standalone: true}" [config]="cm_options">
        </codemirror>-->

        <prosemirror [(data)]="e.body" (blur)="api.change()" (change)="e.modified = 1;">
        </prosemirror>
      </div>
    </ion-slide>
  </ion-slides>

</ion-content>

<ion-footer *ngIf="!api.state.fullscreen">
  <ion-toolbar>

    <ion-buttons start>
      <button ion-button clear icon-only (click)="slider.slidePrev()" [disabled]="slider.isBeginning()">
        <ion-icon name="arrow-back"></ion-icon>
      </button>
    </ion-buttons>

    <ion-title>
      <button ion-button clear icon-only (click)="addPage()">
        <ion-icon name="add"></ion-icon>
      </button>
      <button ion-button clear icon-only (click)="tgInfo = !tgInfo" *ngIf="api.data.length > 0 && api.data[api.getCurrent()]">
        <span *ngIf="tgInfo">
          <ion-badge item-right color="light">Rokfor Id: {{api.data[api.getCurrent()].id}}</ion-badge>&nbsp;
          <ion-badge item-right color="light">Characters: {{api.data[api.getCurrent()].body.length}}</ion-badge>&nbsp;
          <ion-badge item-right color="light">Words: {{wordcount(api.data[api.getCurrent()].body)}}</ion-badge>
        </span>
        <ion-icon *ngIf="!tgInfo" ios="ios-information-circle-outline" md="md-information-circle"></ion-icon>
      </button>
    </ion-title>

    <ion-buttons end *ngIf="initialized">
      <button ion-button clear icon-only (click)="slider.slideNext()" [disabled]="slider.isEnd()">
        <ion-icon name="arrow-forward"></ion-icon>
      </button>
    </ion-buttons>

  </ion-toolbar>
</ion-footer>
